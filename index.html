<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ABADI CENTER - Sistem Data Barang</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); font-family: 'Inter', sans-serif; }
    select option[value="R22"] { background-color: #86efac; }
    select option[value="R32"] { background-color: #93c5fd; }
    select option[value="R410"] { background-color: #f9a8d4; }
    .hidden { display: none; }
  </style>
</head>
<body class="text-gray-800">
  <div id="halamanLogin" class="min-h-screen flex items-center justify-center">
    <div class="bg-white shadow-lg rounded-2xl p-8 w-full max-w-md text-center">
      <h2 class="text-2xl font-bold text-indigo-700 mb-4">Login ke Abadi Center</h2>
      <form id="formLogin" class="space-y-4">
        <input id="loginUsername" class="w-full border-gray-300 rounded-lg p-2 focus:ring-2 focus:ring-indigo-400" placeholder="Username" required />
        <input id="loginPassword" type="password" class="w-full border-gray-300 rounded-lg p-2 focus:ring-2 focus:ring-indigo-400" placeholder="Password" required />
        <button class="w-full py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition">Login</button>
      </form>
      <p class="text-sm mt-4">Belum punya akun? 
        <button id="goDaftar" class="text-indigo-600 font-medium hover:underline">Daftar di sini</button>
      </p>
    </div>
  </div>

  <div id="halamanDaftar" class="min-h-screen flex items-center justify-center hidden">
    <div class="bg-white shadow-lg rounded-2xl p-8 w-full max-w-md text-center">
      <h2 class="text-2xl font-bold text-indigo-700 mb-4">Buat Akun Baru</h2>
      <form id="formDaftar" class="space-y-4">
        <input id="daftarUsername" class="w-full border-gray-300 rounded-lg p-2 focus:ring-2 focus:ring-indigo-400" placeholder="Username" required />
        <input id="daftarPassword" type="password" class="w-full border-gray-300 rounded-lg p-2 focus:ring-2 focus:ring-indigo-400" placeholder="Password" required />
        <button class="w-full py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition">Daftar</button>
      </form>
      <p class="text-sm mt-4">Sudah punya akun?
        <button id="goLogin" class="text-indigo-600 font-medium hover:underline">Login di sini</button>
      </p>
    </div>
  </div>

  <div id="halamanBarang" class="hidden">
    <div class="max-w-6xl mx-auto p-6">
      <header class="mb-6 text-center">
        <h1 class="text-4xl font-bold text-indigo-800 mb-2">WEBSITE INPUT BARANG ABADI CENTER</h1>
        <p class="text-sm text-gray-700">Aplikasi modern untuk menyimpan dan mengelola data barang Anda.</p>
      </header>

      <section class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <div class="bg-white rounded-2xl shadow-lg p-6 border border-gray-200 hover:shadow-2xl transition-all duration-300">
          <h2 class="text-xl font-semibold mb-4 text-indigo-700 flex items-center gap-2">
            <svg xmlns='http://www.w3.org/2000/svg' class='h-5 w-5 text-indigo-500' fill='none' viewBox='0 0 24 24' stroke='currentColor'>
              <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M12 4v16m8-8H4'/>
            </svg>
            Form Input Barang
          </h2>
          <form id="formBarang" class="space-y-4">
            <input type="hidden" id="editingId" />
            <div><label class="text-sm font-medium">Kode Barang</label><input id="kode" class="w-full mt-1 rounded-lg border-gray-300 p-2 focus:ring-2 focus:ring-indigo-400" placeholder="KD001" /></div>
            <div><label class="text-sm font-medium">Nama Barang</label><input id="nama" class="w-full mt-1 rounded-lg border-gray-300 p-2 focus:ring-2 focus:ring-indigo-400" required /></div>
            <div><label class="text-sm font-medium">Ruangan</label><input id="ruangan" class="w-full mt-1 rounded-lg border-gray-300 p-2 focus:ring-2 focus:ring-indigo-400" required /></div>
            <div class="grid grid-cols-2 gap-3">
              <div><label class="text-sm font-medium">Harga (Rp)</label><input id="harga" type="number" min="0" class="w-full mt-1 rounded-lg border-gray-300 p-2 focus:ring-2 focus:ring-indigo-400" /></div>
              <div><label class="text-sm font-medium">Jumlah</label><input id="jumlah" type="number" min="0" class="w-full mt-1 rounded-lg border-gray-300 p-2 focus:ring-2 focus:ring-indigo-400" /></div>
            </div>
            <div><label class="text-sm font-medium">Kondisi Barang</label>
              <select id="kondisi" class="w-full mt-1 rounded-lg border-gray-300 p-2 focus:ring-2 focus:ring-indigo-400">
                <option value="">-- Pilih Kondisi --</option>
                <option value="Bagus">Bagus</option>
                <option value="Sedang">Sedang</option>
                <option value="Tidak Bagus">Tidak Bagus</option>
                <option value="Rusak">Rusak</option>
              </select>
            </div>
            <div><label class="text-sm font-medium">Status Barang</label>
              <select id="status" class="w-full mt-1 rounded-lg border-gray-300 p-2 focus:ring-2 focus:ring-indigo-400">
                <option value="">-- Pilih Status --</option>
                <option value="Sedang diperbaiki">Sedang diperbaiki</option>
                <option value="Menunggu Sparepart">Menunggu Sparepart</option>
                <option value="Sudah Oke">Sudah Oke</option>
              </select>
            </div>
            <div><label class="text-sm font-medium">Isi FREON</label>
              <select id="freon" class="w-full mt-1 rounded-lg border-gray-300 p-2 focus:ring-2 focus:ring-indigo-400">
                <option value="">-- Pilih Jenis FREON --</option>
                <option value="R22">R22 (Warna Hijau)</option>
                <option value="R32">R32 (Warna Biru)</option>
                <option value="R410">R410 (Warna Pink)</option>
              </select>
            </div>
            <div><label class="text-sm font-medium">Deskripsi (opsional)</label>
              <textarea id="deskripsi" rows="2" class="w-full mt-1 rounded-lg border-gray-300 p-2 focus:ring-2 focus:ring-indigo-400"></textarea>
            </div>
            <div class="flex gap-2 pt-2">
              <button type="submit" id="btnSimpan" class="flex-1 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg shadow">Simpan</button>
              <button type="button" id="btnReset" class="flex-1 py-2 bg-gray-200 hover:bg-gray-300 rounded-lg">Reset</button>
            </div>
          </form>
        </div>

        <div class="lg:col-span-2 space-y-4">
          <div class="flex items-center gap-3">
            <input id="search" placeholder="Cari kode / nama / ruangan..." class="flex-1 rounded-lg border-gray-300 p-2 focus:ring-2 focus:ring-indigo-400" />
            <button id="btnClearAll" class="px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg">Hapus Semua</button>
          </div>
          <div class="bg-white rounded-2xl shadow-lg p-4 border border-gray-200 overflow-auto">
            <table class="w-full table-auto text-sm" id="tableBarang">
              <thead class="text-left text-indigo-700 border-b">
                <tr><th class="p-2">#</th><th class="p-2">Kode</th><th class="p-2">Nama</th><th class="p-2">Ruangan</th><th class="p-2">Kondisi</th><th class="p-2">Status</th><th class="p-2">FREON</th><th class="p-2">Harga (Rp)</th><th class="p-2">Jumlah</th><th class="p-2">Total (Rp)</th><th class="p-2">Aksi</th></tr>
              </thead>
              <tbody id="tbodyBarang" class="divide-y divide-gray-100"></tbody>
            </table>
            <div id="emptyState" class="text-center text-gray-500 py-6">Belum ada data barang. Tambah data melalui form di kiri.</div>
          </div>
        </div>
      </section>
    </div>
    <button id="btnLogout" class="fixed top-4 right-4 bg-red-600 text-white px-4 py-2 rounded-lg shadow hover:bg-red-700">Logout</button>
  </div>

  <script>
    /* === AUTENTIKASI TANPA BACKEND === */
    function showPage(id) {
      document.querySelectorAll('#halamanLogin, #halamanDaftar, #halamanBarang').forEach(el => el.classList.add('hidden'));
      document.getElementById(id).classList.remove('hidden');
    }

    const users = JSON.parse(localStorage.getItem('users_abadi') || '[]');
    let activeUser = JSON.parse(localStorage.getItem('activeUser') || 'null');

    const formLogin = document.getElementById('formLogin');
    const formDaftar = document.getElementById('formDaftar');

    const goDaftar = document.getElementById('goDaftar');
    const goLogin = document.getElementById('goLogin');
    const btnLogout = document.getElementById('btnLogout');

    goDaftar.onclick = () => showPage('halamanDaftar');
    goLogin.onclick = () => showPage('halamanLogin');

    formDaftar.onsubmit = e => {
      e.preventDefault();
      const username = daftarUsername.value.trim();
      const password = daftarPassword.value;
      if (users.some(u => u.username === username)) return alert('Username sudah digunakan!');
      users.push({ username, password });
      localStorage.setItem('users_abadi', JSON.stringify(users));
      alert('Akun berhasil dibuat! Silakan login.');
      showPage('halamanLogin');
    };

    formLogin.onsubmit = e => {
      e.preventDefault();
      const username = loginUsername.value.trim();
      const password = loginPassword.value;
      const user = users.find(u => u.username === username && u.password === password);
      if (!user) return alert('Username atau password salah!');
      activeUser = user;
      localStorage.setItem('activeUser', JSON.stringify(user));
      showPage('halamanBarang');
      initBarang();
    };

    btnLogout.onclick = () => {
      if (confirm('Yakin ingin logout?')) {
        localStorage.removeItem('activeUser');
        showPage('halamanLogin');
      }
    };

    /* === HALAMAN BARANG === */
    const fields = ['kode','nama','ruangan','harga','jumlah','kondisi','status','freon','deskripsi'];
    const form = document.getElementById('formBarang');
    const tbody = document.getElementById('tbodyBarang');
    const emptyState = document.getElementById('emptyState');
    const searchEl = document.getElementById('search');
    const btnClearAll = document.getElementById('btnClearAll');
    const editingId = document.getElementById('editingId');
    const btnSimpan = document.getElementById('btnSimpan');
    const btnReset = document.getElementById('btnReset');
    let data = [];

    function uid(){ return Date.now().toString(36)+Math.random().toString(36).slice(2,7); }
    function loadData(){ return JSON.parse(localStorage.getItem(`barang_abadi_${activeUser.username}`)||'[]'); }
    function saveData(list){ localStorage.setItem(`barang_abadi_${activeUser.username}`, JSON.stringify(list)); }

    function render(){
      tbody.innerHTML = '';
      const q = searchEl.value.trim().toLowerCase();
      const list = data.filter(d => !q || Object.values(d).some(v => String(v).toLowerCase().includes(q)));
      if(!list.length){ emptyState.style.display='block'; return; }
      emptyState.style.display='none';
      list.forEach((item,i)=>{
        const tr=document.createElement('tr');
        tr.className=i%2?'bg-gray-50':'';
        tr.innerHTML=`
        <td class='p-2'>${i+1}</td>
        <td class='p-2'>${item.kode}</td>
        <td class='p-2'>${item.nama}</td>
        <td class='p-2'>${item.ruangan}</td>
        <td class='p-2'>${item.kondisi}</td>
        <td class='p-2'>${item.status}</td>
        <td class='p-2 font-semibold text-${item.freon==='R22'?'green':item.freon==='R32'?'blue':'pink'}-600'>${item.freon}</td>
        <td class='p-2'>${item.harga.toLocaleString('id-ID')}</td>
        <td class='p-2'>${item.jumlah}</td>
        <td class='p-2'>${(item.harga*item.jumlah).toLocaleString('id-ID')}</td>
        <td class='p-2 space-x-1'>
          <button data-id='${item.id}' class='editBtn px-2 py-1 bg-yellow-500 text-white rounded text-xs hover:bg-yellow-600'>Edit</button>
          <button data-id='${item.id}' class='deleteBtn px-2 py-1 bg-red-500 text-white rounded text-xs hover:bg-red-600'>Hapus</button>
        </td>`;
        tbody.appendChild(tr);
      });
      document.querySelectorAll('.editBtn').forEach(btn=>btn.onclick=edit);
      document.querySelectorAll('.deleteBtn').forEach(btn=>btn.onclick=del);
    }

    function initBarang(){
      data = loadData();
      render();
    }

    form.onsubmit = e => {
      e.preventDefault();
      const obj = {};
      fields.forEach(f => obj[f]=document.getElementById(f).value);
      obj.harga=Number(obj.harga||0); obj.jumlah=Number(obj.jumlah||0);
      if(editingId.value){
        const idx=data.findIndex(x=>x.id===editingId.value);
        if(idx>-1) data[idx]={...data[idx],...obj};
        editingId.value=''; btnSimpan.textContent='Simpan';
      } else {
        obj.id=uid(); obj.created=Date.now(); data.push(obj);
      }
      saveData(data); form.reset(); render();
    };

    function edit(e){
      const id=e.currentTarget.dataset.id;
      const item=data.find(x=>x.id===id);
      if(!item)return;
      fields.forEach(f=>document.getElementById(f).value=item[f]);
      editingId.value=id; btnSimpan.textContent='Update'; window.scrollTo({top:0,behavior:'smooth'});
    }
    function del(e){
      if(!confirm('Hapus data ini?'))return;
      const id=e.currentTarget.dataset.id;
      data=data.filter(x=>x.id!==id);
      saveData(data); render();
    }

    btnReset.onclick=()=>{form.reset();editingId.value='';btnSimpan.textContent='Simpan';};
    searchEl.oninput=render;
    btnClearAll.onclick=()=>{if(confirm('Hapus semua data?')){data=[];saveData(data);render();}};

    // Jalankan sesuai status login
    if(activeUser) { showPage('halamanBarang'); initBarang(); }
    else { showPage('halamanLogin'); }
  </script>
</body>
</html>
